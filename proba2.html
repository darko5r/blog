<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Posts by Category</title>
  </head>
  <body>
    <h1>Posts by Category</h1>
    <table>
      <thead>
        <tr>
          <th>Title</th>
          <th>Author</th>
          <th>Content</th>
          <th>Date</th>
        </tr>
      </thead>
      <tbody id="post-table-body"></tbody>
    </table>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.6.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.3/firebase-database.js"></script>

    <!-- Your web app's Firebase configuration -->
    <script>
      // Initialize Firebase
      var firebaseConfig = {
        apiKey: "AIzaSyBB00grLIfvhq7EEQV6qiZUZuayP4-GoAg",
        authDomain: "blog-25253.firebaseapp.com",
        databaseURL: "https://blog-25253-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "blog-25253",
        storageBucket: "blog-25253.appspot.com",
        messagingSenderId: "906101390805",
        appId: "1:906101390805:web:871c51f2486921f443115c",
        measurementId: "G-MY3P2TWN4L"
      };
      
      firebase.initializeApp(firebaseConfig);

      // Reference to the posts in the Firebase Database
      var postsRef = firebase.database().ref("posts");
      var categoriesRef = firebase.database().ref("categories");

      // Read the posts from the Firebase Database for a given category
      categoriesRef.child("category1").child("posts").on("value", function(snapshot) {
        // Get the posts data
        var postIds = Object.keys(snapshot.val());
        var numPosts = postIds.length;
        var loadedPosts = 0;
        var posts = {};
        
        for (var i = 0; i < numPosts; i++) {
          var postId = postIds[i];
          postsRef.child(postId).on("value", function(postSnapshot) {
            // Add the post to the posts object
            posts[postId] = postSnapshot.val();
            
            // Check if all posts have been loaded and add them to the table
            loadedPosts++;
            if (loadedPosts === numPosts) {
              var tableBody = document.getElementById("post-table-body");
              for (var postId in posts) {
                if (posts.hasOwnProperty(postId)) {
                  var post = posts[postId];
                  var row = tableBody.insertRow(-1);
                  var titleCell = row.insertCell(0);
                  var authorCell = row.insertCell(1);
                  var contentCell = row.insertCell(2);
                  var dateCell = row.insertCell(3);
                  titleCell.innerText = post.postTitle;
                  authorCell.innerText = post.postAuthor;
                  contentCell.innerText = post.postContent;
                  dateCell.innerText = post.postDate;
                }
              }
            }
          });
        }
      });
    </script>
  </body>
</html>
